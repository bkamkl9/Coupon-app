import{d as _,u as g,r as u,o as y,c as i,a as h,b as d,t as k,_ as x,e as C,g as E,f as V,h as n}from"./index-CoFLDMZ1.js";const w={key:0,class:"flex justify-center items-center h-64"},B={key:1,class:"flex justify-center items-center h-64"},b={class:"text-lg text-red-500"},S=_({__name:"EditCouponView",setup(q){const s=g(),p=C(),f=V(),l=E(),e=u({id:"",status:"in_active",title:"",description:null,link:"",code:"",image_url:null,currency:"PLN",price:0,scheduled_for:null,created_at:""}),c=u(!0),a=u("");async function v(){try{const t=p.params.id;if(!t){a.value="Coupon ID is required";return}const{data:o,error:r}=await l.from("Coupons").select("*").eq("id",t).single();r?a.value=`Failed to load coupon: ${r.message}`:o?e.value=o:a.value="Coupon not found"}catch{a.value="An unexpected error occurred while loading the coupon"}finally{c.value=!1}}async function m(){try{const t={title:e.value.title,description:e.value.description,link:e.value.link,code:e.value.code,image_url:e.value.image_url,currency:e.value.currency,price:e.value.price,scheduled_for:e.value.scheduled_for,status:e.value.status},{error:o}=await l.from("Coupons").update(t).eq("id",e.value.id);o?s.add({title:"Error updating coupon",description:o.message,color:"error"}):(s.add({title:"Coupon updated successfully",color:"success"}),f.push("/coupons"))}catch{s.add({title:"Error updating coupon",description:"An unexpected error occurred",color:"error"})}}return y(v),(t,o)=>c.value?(n(),i("div",w,[...o[1]||(o[1]=[d("div",{class:"text-lg"},"Loading coupon...",-1)])])):a.value?(n(),i("div",B,[d("div",b,k(a.value),1)])):(n(),h(x,{key:2,modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=r=>e.value=r),mode:"edit",onSave:m},null,8,["modelValue"]))}});export{S as default};
